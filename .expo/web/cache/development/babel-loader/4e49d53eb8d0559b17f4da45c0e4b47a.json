{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jdavid/Documents/idken/idken3/idken/src/Components/IctAcademy/IctAcademy.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport Item from \"../Item/Item\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport queryString from \"query-string\";\nimport Api from \"../../Api\";\nimport Paging from \"../Paging/Paging\";\nimport ProductsHeader from \"../ProductsHeader/ProductsHeader\";\n\nvar IctAcademy = function (_Component) {\n  _inherits(IctAcademy, _Component);\n\n  var _super = _createSuper(IctAcademy);\n\n  function IctAcademy(props) {\n    var _this;\n\n    _classCallCheck(this, IctAcademy);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      loading: false,\n      totalItemsCount: null,\n      items: []\n    };\n    _this.updateQueryString = _this.updateQueryString.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(IctAcademy, [{\n    key: \"fetchData\",\n    value: function fetchData() {\n      var qsAsObject, results;\n      return _regeneratorRuntime.async(function fetchData$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              this.setState({\n                loading: true\n              });\n              qsAsObject = queryString.parse(this.props.location.search);\n              _context.next = 4;\n              return _regeneratorRuntime.awrap(Api.searchItems(qsAsObject));\n\n            case 4:\n              results = _context.sent;\n              this.setState({\n                items: results.data,\n                loading: false,\n                totalItemsCount: results.totalLength\n              });\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.fetchData();\n    }\n  }, {\n    key: \"updateQueryString\",\n    value: function updateQueryString(newValues) {\n      var currentQS = queryString.parse(this.props.location.search);\n\n      var newQS = _objectSpread(_objectSpread({}, currentQS), newValues);\n\n      this.props.history.push(\"/?\" + queryString.stringify(newQS));\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState, snapshot) {\n      var currentQS = queryString.parse(this.props.location.search);\n      var oldQS = queryString.parse(prevProps.location.search);\n\n      var areSameObjects = function areSameObjects(a, b) {\n        if (Object.keys(a).length !== Object.keys(b).length) return false;\n\n        for (var key in a) {\n          if (a[key] !== b[key]) return false;\n        }\n\n        return true;\n      };\n\n      if (!areSameObjects(currentQS, oldQS)) {\n        this.fetchData();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var parsedQS = queryString.parse(this.props.location.search);\n\n      if (this.state.loading) {\n        return React.createElement(CircularProgress, {\n          className: \"circular\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 75,\n            columnNumber: 9\n          }\n        });\n      }\n\n      return React.createElement(\"div\", {\n        style: {\n          height: \"100%\",\n          display: \"flex\",\n          flexDirection: \"column\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 7\n        }\n      }, React.createElement(\"div\", {\n        style: {\n          flex: 1\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 9\n        }\n      }, this.state.items.map(function (item) {\n        return React.createElement(Item, {\n          key: item.id,\n          item: item,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 20\n          }\n        });\n      })));\n    }\n  }]);\n\n  return IctAcademy;\n}(Component);\n\nexport default IctAcademy;","map":{"version":3,"sources":["/Users/jdavid/Documents/idken/idken3/idken/src/Components/IctAcademy/IctAcademy.js"],"names":["React","Component","Item","CircularProgress","queryString","Api","Paging","ProductsHeader","IctAcademy","props","state","loading","totalItemsCount","items","updateQueryString","bind","setState","qsAsObject","parse","location","search","searchItems","results","data","totalLength","fetchData","newValues","currentQS","newQS","history","push","stringify","prevProps","prevState","snapshot","oldQS","areSameObjects","a","b","Object","keys","length","key","parsedQS","height","display","flexDirection","flex","map","item","id"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Item from \"../Item/Item\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport queryString from \"query-string\";\nimport Api from \"../../Api\";\nimport Paging from \"../Paging/Paging\";\nimport ProductsHeader from \"../ProductsHeader/ProductsHeader\"\n\n\n// This component is responsible for fetching products. It determines from query string which products to fetch.\n// The URL is checked on initial mount and when URL changes.\nclass IctAcademy extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      loading: false,\n      totalItemsCount: null,\n      items: []\n    };\n    this.updateQueryString = this.updateQueryString.bind(this);\n\n  }\n\n  async fetchData() {\n\n    this.setState({ loading: true });\n\n    // Parse the query string\n    let qsAsObject = queryString.parse(this.props.location.search);\n\n    let results = await Api.searchItems(qsAsObject);\n\n    this.setState({\n      items: results.data,\n      loading: false,\n      totalItemsCount: results.totalLength\n    });\n  }\n\n  componentDidMount() {\n    this.fetchData();\n  }\n\n  updateQueryString(newValues) {\n    let currentQS = queryString.parse(this.props.location.search);\n    let newQS = { ...currentQS, ...newValues };\n    this.props.history.push(\"/?\" + queryString.stringify(newQS));\n  }\n\n  componentDidUpdate(prevProps, prevState, snapshot) {\n\n    let currentQS = queryString.parse(this.props.location.search);\n    let oldQS = queryString.parse(prevProps.location.search);\n    \n    let areSameObjects = (a, b) => {\n      if (Object.keys(a).length !== Object.keys(b).length) return false;\n      for (let key in a) {\n              if (a[key] !== b[key]) return false;\n      }\n      return true;\n    }\n\n    // We will refetch products only when query string changes.\n    if (!areSameObjects(currentQS,oldQS )) {\n      this.fetchData();\n    }\n  }\n\n  render() {\n    let parsedQS = queryString.parse(this.props.location.search);\n\n    if (this.state.loading) {\n      return (\n        <CircularProgress className=\"circular\" />\n      );\n    }\n\n    return (\n      <div style={{ height: \"100%\", display: \"flex\", flexDirection: \"column\" }}>\n\n        <div style={{ flex: 1 }}>\n          {this.state.items.map(item => {\n            return <Item key={item.id} item={item} />;\n          })}\n        </div>\n\n      </div >\n    );\n  }\n}\n\nexport default IctAcademy;\n"]},"metadata":{},"sourceType":"module"}